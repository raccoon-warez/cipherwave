System.register([],function(e,a){"use strict";return{execute:function(){var e=document.createElement("style");e.textContent=':root{--primary: #0088cc;--primary-dark: #006ba6;--primary-light: #33a3d9;--secondary: #40a7e3;--accent: #64b5f6;--bg-primary: #212121;--bg-secondary: #1e1e1e;--bg-tertiary: #2c2c2c;--bg-chat: #0f0f0f;--bg-message-sent: #0088cc;--bg-message-received: #2c2c2c;--bg-sidebar: #1a1a1a;--text-primary: #ffffff;--text-secondary: #aaaaaa;--text-muted: #666666;--text-accent: #0088cc;--success: #4caf50;--warning: #ff9800;--danger: #f44336;--info: #2196f3;--online: #4caf50;--offline: #666666;--border-color: #333333;--border-light: #404040;--shadow-sm: 0 2px 4px rgba(0, 0, 0, .1);--shadow-md: 0 4px 8px rgba(0, 0, 0, .15);--shadow-lg: 0 8px 16px rgba(0, 0, 0, .2);--shadow-xl: 0 12px 24px rgba(0, 0, 0, .25);--radius-sm: 4px;--radius-md: 8px;--radius-lg: 12px;--radius-xl: 16px;--radius-full: 50%;--transition-fast: .15s ease;--transition-normal: .25s ease;--transition-slow: .35s ease;--spacing-xs: 4px;--spacing-sm: 8px;--spacing-md: 16px;--spacing-lg: 24px;--spacing-xl: 32px;--font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;--font-size-xs: .75rem;--font-size-sm: .875rem;--font-size-base: 1rem;--font-size-lg: 1.125rem;--font-size-xl: 1.25rem;--font-size-2xl: 1.5rem;--font-size-3xl: 1.875rem;--sidebar-width: 320px;--sidebar-collapsed-width: 60px;--header-height: 60px;--input-height: 48px}*{box-sizing:border-box;margin:0;padding:0}html{font-size:16px;scroll-behavior:smooth}body{font-family:var(--font-family);background:var(--bg-primary);color:var(--text-primary);line-height:1.5;overflow-x:hidden;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.telegram-app{display:flex;height:100vh;background:var(--bg-primary)}.sidebar{width:var(--sidebar-width);background:var(--bg-sidebar);border-right:1px solid var(--border-color);display:flex;flex-direction:column;transition:width var(--transition-normal);z-index:100}.sidebar.collapsed{width:var(--sidebar-collapsed-width)}.sidebar-header{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md);border-bottom:1px solid var(--border-color);height:var(--header-height)}.app-logo{display:flex;align-items:center;gap:var(--spacing-sm)}.logo-icon{width:32px;height:32px;border-radius:var(--radius-md)}.logo-text{font-size:var(--font-size-lg);font-weight:600;color:var(--text-primary);transition:opacity var(--transition-normal)}.sidebar.collapsed .logo-text{opacity:0;width:0;overflow:hidden}.sidebar-toggle{background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast)}.sidebar-toggle:hover{background:var(--bg-tertiary);color:var(--text-primary)}.user-profile-sidebar{padding:var(--spacing-md);border-bottom:1px solid var(--border-color)}.user-avatar-container{position:relative;margin-bottom:var(--spacing-sm)}.user-avatar{width:48px;height:48px;border-radius:var(--radius-full);object-fit:cover;border:2px solid var(--primary)}.status-indicator{position:absolute;bottom:2px;right:2px;width:12px;height:12px;border-radius:var(--radius-full);border:2px solid var(--bg-sidebar)}.status-indicator.online{background:var(--online)}.status-indicator.offline{background:var(--offline)}.user-details{transition:opacity var(--transition-normal)}.sidebar.collapsed .user-details{opacity:0;height:0;overflow:hidden}.user-name{font-size:var(--font-size-base);font-weight:600;color:var(--text-primary);margin-bottom:2px}.user-status{font-size:var(--font-size-sm);color:var(--text-secondary);margin-bottom:var(--spacing-xs)}.user-id{font-size:var(--font-size-xs);color:var(--text-muted);font-family:Monaco,Menlo,monospace;background:var(--bg-tertiary);padding:2px 6px;border-radius:var(--radius-sm);display:inline-block}.sidebar-nav{flex:1;padding:var(--spacing-md) 0}.nav-item{display:flex;align-items:center;gap:var(--spacing-md);width:100%;padding:var(--spacing-md);background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-base);cursor:pointer;transition:all var(--transition-fast);position:relative}.nav-item:hover{background:var(--bg-tertiary);color:var(--text-primary)}.nav-item.active{background:var(--primary);color:#fff}.nav-item.active:before{content:"";position:absolute;left:0;top:0;bottom:0;width:3px;background:#fff}.nav-item i{width:20px;text-align:center;font-size:var(--font-size-lg)}.nav-item span:not(.badge){transition:opacity var(--transition-normal)}.sidebar.collapsed .nav-item span:not(.badge){opacity:0;width:0;overflow:hidden}.badge{background:var(--danger);color:#fff;font-size:var(--font-size-xs);padding:2px 6px;border-radius:var(--radius-full);margin-left:auto;min-width:18px;text-align:center}.connection-status-sidebar{padding:var(--spacing-md);border-top:1px solid var(--border-color)}.status-indicator-container{display:flex;align-items:center;gap:var(--spacing-sm);transition:opacity var(--transition-normal)}.sidebar.collapsed .status-indicator-container span{opacity:0;width:0;overflow:hidden}.status-dot{width:8px;height:8px;border-radius:var(--radius-full);background:var(--offline);transition:background var(--transition-fast)}.status-dot.connected{background:var(--online)}.status-dot.connecting{background:var(--warning);animation:pulse 2s infinite}.main-content{flex:1;display:flex;flex-direction:column;background:var(--bg-secondary);overflow:hidden}.view{display:none;flex-direction:column;height:100%}.view.active{display:flex}.view-header{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);background:var(--bg-secondary);height:var(--header-height)}.view-header h2{font-size:var(--font-size-xl);font-weight:600;color:var(--text-primary)}.header-actions{display:flex;gap:var(--spacing-sm)}.action-btn{background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast)}.action-btn:hover{background:var(--bg-tertiary);color:var(--text-primary)}.search-bar{padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);background:var(--bg-secondary)}.search-input{width:100%;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-lg);color:var(--text-primary);font-size:var(--font-size-base);outline:none;transition:all var(--transition-fast)}.search-input:focus{border-color:var(--primary);box-shadow:0 0 0 2px rgba(0,136,204,.2)}.chat-list{flex:1;overflow-y:auto;background:var(--bg-secondary)}.chat-item{display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);cursor:pointer;transition:background var(--transition-fast)}.chat-item:hover{background:var(--bg-tertiary)}.chat-item.active{background:var(--primary)}.chat-avatar{width:48px;height:48px;border-radius:var(--radius-full);object-fit:cover;flex-shrink:0}.chat-info{flex:1;min-width:0}.chat-name{font-size:var(--font-size-base);font-weight:500;color:var(--text-primary);margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chat-preview{font-size:var(--font-size-sm);color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chat-meta{display:flex;flex-direction:column;align-items:flex-end;gap:var(--spacing-xs);flex-shrink:0}.chat-time{font-size:var(--font-size-xs);color:var(--text-muted)}.unread-badge{background:var(--primary);color:#fff;font-size:var(--font-size-xs);padding:2px 6px;border-radius:var(--radius-full);min-width:18px;text-align:center}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:var(--spacing-xl);text-align:center}.empty-state i{font-size:4rem;color:var(--text-muted);margin-bottom:var(--spacing-lg)}.empty-state h3{font-size:var(--font-size-xl);color:var(--text-primary);margin-bottom:var(--spacing-sm)}.empty-state p{font-size:var(--font-size-base);color:var(--text-secondary);margin-bottom:var(--spacing-lg);max-width:300px}.primary-btn{background:var(--primary);color:#fff;border:none;padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-fast);display:inline-flex;align-items:center;gap:var(--spacing-sm)}.primary-btn:hover{background:var(--primary-dark);transform:translateY(-1px);box-shadow:var(--shadow-md)}.secondary-btn{background:var(--bg-tertiary);color:var(--text-primary);border:1px solid var(--border-color);padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-fast);display:inline-flex;align-items:center;gap:var(--spacing-sm)}.secondary-btn:hover{background:var(--bg-primary);border-color:var(--border-light)}.settings-content{flex:1;overflow-y:auto;padding:var(--spacing-lg)}.settings-section{margin-bottom:var(--spacing-xl)}.settings-section h3{font-size:var(--font-size-lg);font-weight:600;color:var(--text-primary);margin-bottom:var(--spacing-md)}.setting-item{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) 0;border-bottom:1px solid var(--border-color)}.setting-item:last-child{border-bottom:none}.setting-item label{font-size:var(--font-size-base);color:var(--text-primary);font-weight:500}.setting-input{background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-sm) var(--spacing-md);color:var(--text-primary);font-size:var(--font-size-base);outline:none;transition:all var(--transition-fast);min-width:200px}.setting-input:focus{border-color:var(--primary);box-shadow:0 0 0 2px rgba(0,136,204,.2)}.mode-buttons{display:flex;gap:var(--spacing-md);margin-bottom:var(--spacing-md)}.mode-btn{flex:1;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-lg);padding:var(--spacing-lg);color:var(--text-primary);cursor:pointer;transition:all var(--transition-fast);display:flex;flex-direction:column;align-items:center;gap:var(--spacing-sm)}.mode-btn:hover{background:var(--bg-primary);border-color:var(--primary)}.mode-btn.active{background:var(--primary);border-color:var(--primary);color:#fff}.mode-btn i{font-size:var(--font-size-2xl)}.status-message{padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-radius:var(--radius-md);font-size:var(--font-size-sm);color:var(--text-secondary)}.security-content{flex:1;overflow-y:auto;padding:var(--spacing-lg)}.security-section{margin-bottom:var(--spacing-xl)}.security-section h3{font-size:var(--font-size-lg);font-weight:600;color:var(--text-primary);margin-bottom:var(--spacing-md)}.encryption-info{background:var(--bg-tertiary);border-radius:var(--radius-lg);padding:var(--spacing-lg)}.encryption-item{display:flex;align-items:center;gap:var(--spacing-md);margin-bottom:var(--spacing-md);font-size:var(--font-size-base);color:var(--text-primary)}.encryption-item:last-child{margin-bottom:0}.encryption-item i{color:var(--success);font-size:var(--font-size-lg)}.debug-panel{background:var(--bg-tertiary);border-radius:var(--radius-lg);padding:var(--spacing-lg)}.debug-logs{background:var(--bg-chat);border-radius:var(--radius-md);padding:var(--spacing-md);margin-bottom:var(--spacing-md);min-height:200px;max-height:400px;overflow-y:auto;font-family:Monaco,Menlo,monospace;font-size:var(--font-size-sm);color:var(--text-secondary);line-height:1.4}.debug-actions{display:flex;gap:var(--spacing-sm)}.chat-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:1000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px)}.chat-window{width:90vw;max-width:800px;height:90vh;background:var(--bg-secondary);border-radius:var(--radius-xl);display:flex;flex-direction:column;overflow:hidden;box-shadow:var(--shadow-xl)}.chat-header{display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md) var(--spacing-lg);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);height:var(--header-height)}.back-btn{background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast)}.back-btn:hover{background:var(--bg-secondary);color:var(--text-primary)}.chat-info{display:flex;align-items:center;gap:var(--spacing-md);flex:1}.peer-avatar{width:40px;height:40px;border-radius:var(--radius-full);object-fit:cover}.peer-details h3{font-size:var(--font-size-base);font-weight:600;color:var(--text-primary);margin-bottom:2px}.peer-details p{font-size:var(--font-size-sm);color:var(--text-secondary)}.chat-actions{display:flex;gap:var(--spacing-sm)}.messages-container{flex:1;overflow-y:auto;padding:var(--spacing-lg);background:var(--bg-chat);background-image:radial-gradient(circle at 1px 1px,rgba(255,255,255,.05) 1px,transparent 0);background-size:20px 20px}.welcome-message{display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);padding:var(--spacing-lg);background:var(--bg-tertiary);border-radius:var(--radius-lg);margin-bottom:var(--spacing-lg);color:var(--text-secondary);font-size:var(--font-size-sm);text-align:center}.welcome-message i{color:var(--success);font-size:var(--font-size-lg)}.message{display:flex;margin-bottom:var(--spacing-md);animation:messageSlideIn .3s ease-out}.message.sent{justify-content:flex-end}.message.received{justify-content:flex-start}.message-bubble{max-width:70%;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-lg);position:relative;word-wrap:break-word}.message.sent .message-bubble{background:var(--bg-message-sent);color:#fff;border-bottom-right-radius:var(--radius-sm)}.message.received .message-bubble{background:var(--bg-message-received);color:var(--text-primary);border-bottom-left-radius:var(--radius-sm)}.message-content{font-size:var(--font-size-base);line-height:1.4;margin-bottom:var(--spacing-xs)}.message-meta{display:flex;align-items:center;justify-content:flex-end;gap:var(--spacing-xs);font-size:var(--font-size-xs);opacity:.7}.message.sent .message-meta{color:rgba(255,255,255,.8)}.message.received .message-meta{color:var(--text-muted)}.message-status{font-size:var(--font-size-xs)}.message-status.pending{color:var(--warning)}.message-status.failed{color:var(--danger)}.message-input-container{padding:var(--spacing-md) var(--spacing-lg);background:var(--bg-tertiary);border-top:1px solid var(--border-color)}.input-wrapper{display:flex;align-items:center;gap:var(--spacing-sm);background:var(--bg-secondary);border-radius:var(--radius-lg);padding:var(--spacing-sm)}.attachment-btn,.emoji-btn{background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast)}.attachment-btn:hover,.emoji-btn:hover{background:var(--bg-tertiary);color:var(--text-primary)}.message-input{flex:1;background:none;border:none;color:var(--text-primary);font-size:var(--font-size-base);outline:none;padding:var(--spacing-sm) 0}.message-input::placeholder{color:var(--text-muted)}.send-btn{background:var(--primary);border:none;color:#fff;font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast);display:flex;align-items:center;justify-content:center}.send-btn:hover{background:var(--primary-dark);transform:scale(1.05)}.send-btn:disabled{background:var(--text-muted);cursor:not-allowed;transform:none}.modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:1000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px)}.modal-content{background:var(--bg-secondary);border-radius:var(--radius-xl);width:90vw;max-width:500px;max-height:90vh;overflow:hidden;box-shadow:var(--shadow-xl)}.modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-lg);border-bottom:1px solid var(--border-color)}.modal-header h3{font-size:var(--font-size-xl);font-weight:600;color:var(--text-primary)}.close-btn{background:none;border:none;color:var(--text-secondary);font-size:var(--font-size-lg);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-md);transition:all var(--transition-fast)}.close-btn:hover{background:var(--bg-tertiary);color:var(--text-primary)}.modal-body{padding:var(--spacing-lg)}.form-group{margin-bottom:var(--spacing-lg)}.form-group:last-child{margin-bottom:0}.form-group label{display:block;font-size:var(--font-size-base);font-weight:500;color:var(--text-primary);margin-bottom:var(--spacing-sm)}.input-group{display:flex;gap:var(--spacing-sm)}.modal-input{flex:1;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-sm) var(--spacing-md);color:var(--text-primary);font-size:var(--font-size-base);outline:none;transition:all var(--transition-fast)}.modal-input:focus{border-color:var(--primary);box-shadow:0 0 0 2px rgba(0,136,204,.2)}.status-display{padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-radius:var(--radius-md);font-size:var(--font-size-sm);color:var(--text-secondary)}.modal-footer{display:flex;gap:var(--spacing-sm);justify-content:flex-end;padding:var(--spacing-lg);border-top:1px solid var(--border-color)}.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:2000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px)}.loading-spinner{display:flex;flex-direction:column;align-items:center;gap:var(--spacing-lg);color:var(--text-primary)}.spinner{width:40px;height:40px;border:3px solid var(--bg-tertiary);border-top:3px solid var(--primary);border-radius:var(--radius-full);animation:spin 1s linear infinite}.hidden{display:none!important}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}@keyframes messageSlideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 1024px){.sidebar{width:280px}.chat-window{width:95vw;height:95vh}}@media (max-width: 768px){.telegram-app{flex-direction:column;height:100vh;height:100dvh}.sidebar{width:100%;height:auto;max-height:60px;border-right:none;border-bottom:1px solid var(--border-color);flex-direction:row;overflow-x:auto;overflow-y:hidden;position:relative;z-index:200}.sidebar.collapsed{width:100%;max-height:60px}.sidebar.mobile-expanded{max-height:300px;flex-direction:column;overflow-y:auto;overflow-x:hidden}.sidebar-header{flex-shrink:0;min-width:200px;border-bottom:none;border-right:1px solid var(--border-color)}.sidebar.mobile-expanded .sidebar-header{width:100%;min-width:auto;border-right:none;border-bottom:1px solid var(--border-color)}.user-profile-sidebar{display:none}.sidebar.mobile-expanded .user-profile-sidebar{display:block}.sidebar-nav{flex-direction:row;padding:0;overflow-x:auto;overflow-y:hidden;flex:1}.sidebar.mobile-expanded .sidebar-nav{flex-direction:column;padding:var(--spacing-md) 0;overflow-x:hidden;overflow-y:auto}.nav-item{min-width:80px;flex-shrink:0;flex-direction:column;gap:var(--spacing-xs);padding:var(--spacing-sm);text-align:center}.sidebar.mobile-expanded .nav-item{min-width:auto;flex-direction:row;gap:var(--spacing-md);padding:var(--spacing-md);text-align:left}.nav-item span:not(.badge){font-size:var(--font-size-xs);opacity:1;width:auto}.sidebar.mobile-expanded .nav-item span:not(.badge){font-size:var(--font-size-base)}.connection-status-sidebar{display:none}.sidebar.mobile-expanded .connection-status-sidebar{display:block}.main-content{flex:1;min-height:0}.chat-overlay{padding:0;position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000}.chat-window{width:100vw;height:100vh;height:100dvh;border-radius:0;max-width:none;max-height:none}.modal-content{width:95vw;margin:var(--spacing-md);max-height:85vh;max-height:85dvh}.mode-buttons,.input-group{flex-direction:column;gap:var(--spacing-sm)}.modal-footer{flex-direction:column-reverse;gap:var(--spacing-sm)}.action-btn,.nav-item,.chat-item{min-height:44px;min-width:44px}.primary-btn,.secondary-btn{min-height:48px;padding:var(--spacing-md) var(--spacing-lg)}.messages-container{padding:var(--spacing-md);padding-bottom:calc(var(--spacing-lg) + env(safe-area-inset-bottom))}.message-input-container{padding:var(--spacing-md);padding-bottom:calc(var(--spacing-md) + env(safe-area-inset-bottom));background:var(--bg-tertiary)}.input-wrapper{min-height:48px}.message-input{font-size:16px;line-height:1.4}.chat-window.keyboard-open{height:100vh;height:100dvh}.chat-window.keyboard-open .messages-container{max-height:calc(100vh - 200px);max-height:calc(100dvh - 200px)}}@media (max-width: 480px){:root{--spacing-xs: 2px;--spacing-sm: 6px;--spacing-md: 12px;--spacing-lg: 18px;--spacing-xl: 24px;--font-size-xs: .7rem;--font-size-sm: .8rem;--font-size-base: .9rem;--font-size-lg: 1rem;--font-size-xl: 1.1rem;--font-size-2xl: 1.3rem}.view-header{padding:var(--spacing-md);height:50px}.view-header h2{font-size:var(--font-size-lg)}.settings-content,.security-content{padding:var(--spacing-md)}.setting-item{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm);padding:var(--spacing-sm) 0}.setting-input{width:100%;min-width:auto;font-size:16px}.message-bubble{max-width:90%;padding:var(--spacing-sm) var(--spacing-md)}.message-content{font-size:var(--font-size-sm)}.chat-header{padding:var(--spacing-sm) var(--spacing-md);height:50px}.peer-avatar{width:32px;height:32px}.peer-details h3{font-size:var(--font-size-sm)}.peer-details p{font-size:var(--font-size-xs)}.sidebar-header{height:50px;padding:var(--spacing-sm) var(--spacing-md)}.logo-icon{width:24px;height:24px}.logo-text{font-size:var(--font-size-base)}.nav-item{min-width:60px;padding:var(--spacing-xs)}.nav-item i{font-size:var(--font-size-base)}.nav-item span:not(.badge){font-size:.6rem}.modal-content{width:98vw;margin:var(--spacing-xs);border-radius:var(--radius-lg)}.modal-header,.modal-body,.modal-footer{padding:var(--spacing-md)}}@media (max-width: 360px){.message-bubble{max-width:95%;padding:var(--spacing-xs) var(--spacing-sm)}.nav-item{min-width:50px}.nav-item span:not(.badge){display:none}.sidebar.mobile-expanded .nav-item span:not(.badge){display:inline}}@media (hover: none) and (pointer: coarse){.action-btn:hover,.nav-item:hover,.chat-item:hover,.primary-btn:hover,.secondary-btn:hover{background:var(--bg-tertiary);transform:none}.primary-btn:active{background:var(--primary-dark);transform:scale(.98)}.send-btn:active{transform:scale(.95)}.sidebar-toggle:hover,.close-btn:hover,.back-btn:hover{background:var(--bg-tertiary)}}@media (max-width: 896px) and (orientation: landscape) and (max-height: 500px){.telegram-app{flex-direction:row}.sidebar{width:240px;height:100vh;max-height:none;flex-direction:column;border-right:1px solid var(--border-color);border-bottom:none}.sidebar-header{border-bottom:1px solid var(--border-color);border-right:none}.sidebar-nav{flex-direction:column;padding:var(--spacing-md) 0}.nav-item{flex-direction:row;min-width:auto;text-align:left;gap:var(--spacing-md);padding:var(--spacing-md)}.nav-item span:not(.badge){font-size:var(--font-size-base);display:inline}.user-profile-sidebar,.connection-status-sidebar{display:block}.chat-window{height:100vh}}@supports (padding: max(0px)){.telegram-app{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right)}.sidebar-header,.view-header,.chat-header{padding-top:max(var(--spacing-md),env(safe-area-inset-top))}.message-input-container{padding-bottom:max(var(--spacing-md),env(safe-area-inset-bottom))}.modal-content{margin-top:max(var(--spacing-lg),env(safe-area-inset-top));margin-bottom:max(var(--spacing-lg),env(safe-area-inset-bottom))}}@media (display-mode: standalone){.telegram-app{height:100vh;height:100dvh}.view-header,.chat-header{padding-top:max(var(--spacing-md),env(safe-area-inset-top))}}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg-tertiary)}::-webkit-scrollbar-thumb{background:var(--border-light);border-radius:var(--radius-sm)}::-webkit-scrollbar-thumb:hover{background:var(--text-muted)}.modern-app{max-width:500px;margin:20px auto;border-radius:var(--border-radius-lg);background:rgba(35,38,58,.7);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 8px 32px var(--shadow);overflow:hidden;border:1px solid rgba(53,58,80,.3);animation:fadeIn .5s ease-out}.modern-header{background:var(--gradient-primary);padding:32px 0 24px;text-align:center;position:relative;overflow:hidden}.modern-header:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1),rgba(255,255,255,0) 70%);animation:rotate 10s linear infinite;z-index:0}.logo-card{position:relative;z-index:1;margin:0 auto;padding:0 16px}.logo-title{font-size:2.5rem;font-weight:800;letter-spacing:1px;color:#fff;margin-bottom:8px;text-shadow:0 2px 4px rgba(0,0,0,.2);animation:pulse 2s infinite}.logo-desc{font-size:1.1rem;color:rgba(255,255,255,.9);font-weight:500}.user-profile{display:flex;align-items:center;padding:20px;background:rgba(35,38,58,.5);border-bottom:1px solid var(--card-border);animation:slideIn .5s ease-out}.avatar-container{position:relative;margin-right:16px}.user-avatar{width:60px;height:60px;border-radius:50%;object-fit:cover;border:3px solid var(--primary);box-shadow:0 4px 12px rgba(0,0,0,.2);transition:var(--transition)}.user-avatar:hover{transform:scale(1.05);box-shadow:0 6px 16px rgba(108,99,255,.4)}.avatar-badge{position:absolute;bottom:0;right:0;width:20px;height:20px;background:var(--success);border-radius:50%;border:2px solid var(--card-bg)}.user-info{flex:1}.user-name{font-size:1.3rem;font-weight:600;margin-bottom:4px;color:var(--text-primary)}.user-id{font-size:.9rem;color:var(--text-secondary);font-family:monospace;background:rgba(53,58,80,.5);padding:2px 8px;border-radius:var(--border-radius-sm);display:inline-block}.modern-main{padding:20px}.card{background:var(--card-bg);border-radius:var(--border-radius-md);box-shadow:0 4px 20px var(--shadow-light);margin-bottom:24px;padding:24px;transition:var(--transition);border:1px solid rgba(53,58,80,.5);position:relative;overflow:hidden}.card:before{content:"";position:absolute;top:0;left:0;width:100%;height:4px;background:var(--gradient-primary);transform:scaleX(0);transform-origin:left;transition:transform .3s ease}.card:hover:before{transform:scaleX(1)}.card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,.3)}.card-title{font-size:1.4rem;color:var(--primary);margin-bottom:16px;font-weight:700;display:flex;align-items:center}.card-title i{margin-right:10px;font-size:1.2rem}.panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.toggle-btn{background:rgba(53,58,80,.5);color:var(--text-secondary);border:none;border-radius:50%;width:36px;height:36px;font-size:1.1rem;cursor:pointer;transition:var(--transition);display:flex;align-items:center;justify-content:center}.toggle-btn:hover{background:var(--primary);color:#fff;transform:rotate(90deg)}.form-group{margin-bottom:20px}.form-group label{display:block;margin-bottom:8px;font-weight:500;color:var(--text-secondary)}.input-group{display:flex;gap:12px;align-items:center}.input-modern{background:rgba(24,26,32,.7);color:var(--text-primary);border:2px solid var(--card-border);border-radius:var(--border-radius-sm);padding:12px 16px;font-size:1rem;outline:none;transition:var(--transition);flex:1;box-shadow:inset 0 2px 4px rgba(0,0,0,.1)}.input-modern:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(108,99,255,.2)}.input-modern:hover{border-color:var(--primary-light)}.accent-btn{background:var(--gradient-primary);color:#fff;border:none;border-radius:var(--border-radius-sm);padding:12px 20px;font-size:1rem;font-weight:600;cursor:pointer;box-shadow:0 4px 12px rgba(108,99,255,.3);transition:var(--transition);position:relative;overflow:hidden;display:inline-flex;align-items:center;justify-content:center}.accent-btn:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:.5s}.accent-btn:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(108,99,255,.4)}.accent-btn:hover:before{left:100%}.accent-btn:active{transform:translateY(0) scale(.98)}.accent-btn:disabled{background:var(--card-border);color:var(--text-secondary);cursor:not-allowed;box-shadow:none;transform:none}.accent-btn:disabled:hover{transform:none;box-shadow:none}.mode-group,.node-btn-group,.connection-btn-group{display:flex;gap:16px;margin-bottom:16px}.mode-btn{flex:1}.status-text{font-size:1rem;color:var(--text-secondary);margin-top:12px;padding:12px 16px;border-radius:var(--border-radius-sm);background:rgba(24,26,32,.7);border-left:4px solid var(--primary);font-weight:500;display:flex;align-items:center}.status-text i{margin-right:10px;font-size:1.2rem}.status-connected{background:rgba(76,175,80,.15);border-left-color:var(--success);color:var(--success)}.status-disconnected{background:rgba(244,67,54,.15);border-left-color:var(--danger);color:var(--danger)}.status-warning{background:rgba(255,152,0,.15);border-left-color:var(--warning);color:var(--warning)}.card.chat-card{display:flex;flex-direction:column;height:70vh;max-height:70vh;padding:0}.chat-header{padding:20px;border-bottom:1px solid var(--card-border);display:flex;align-items:center}.chat-header .user-avatar{width:40px;height:40px;margin-right:12px}.chat-header-info h3{font-size:1.2rem;margin-bottom:4px}.chat-header-info p{font-size:.9rem;color:var(--text-secondary)}.messages-modern{flex:1;overflow-y:auto;padding:20px;background:rgba(24,26,32,.3);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px)}.message{margin-bottom:16px;padding:12px 16px;border-radius:var(--border-radius-md);background:var(--card-bg);box-shadow:0 2px 8px rgba(0,0,0,.1);display:flex;flex-direction:column;animation:fadeIn .3s ease-out;position:relative;overflow:hidden;border:1px solid rgba(53,58,80,.3);transition:var(--transition)}.message:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.15)}.message.sent{background:var(--gradient-primary);color:#fff;align-items:flex-end;margin-left:20%;border:none}.message.sent .message-info{color:rgba(255,255,255,.8)}.message.received{background:var(--card-bg);color:var(--text-primary);align-items:flex-start;margin-right:20%}.message-content{font-size:1rem;line-height:1.4;margin-bottom:8px;word-wrap:break-word}.message-info{font-size:.8rem;color:var(--text-secondary);display:flex;align-items:center;justify-content:flex-end;width:100%}.message-status{margin-left:6px;font-size:.9rem}.message-status.delivered{color:var(--success)}.message-status.not-delivered{color:var(--danger)}.chat-input-area{display:flex;gap:12px;padding:16px;border-top:1px solid var(--card-border);background:var(--card-bg)}.chat-input-area .input-modern{flex:1;margin-bottom:0}.card.debug-card{background:rgba(30,32,48,.8)}.card.debug-card .card-title{color:var(--warning)}#debug-logs{min-height:150px;max-height:250px;overflow-y:auto;background:rgba(24,26,32,.7);border-radius:var(--border-radius-sm);padding:16px;margin-bottom:20px;font-family:Fira Code,Monaco,monospace;font-size:.9rem;color:var(--text-secondary);border:1px solid var(--card-border)}.debug-log-entry{margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid rgba(53,58,80,.3);animation:slideIn .2s ease-out}.debug-log-entry:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}.collapsible-content{max-height:1000px;overflow:hidden;transition:max-height .4s ease-out}.collapsible-content.collapsed{max-height:0;transition:max-height .3s ease-out}.modern-footer{background:var(--card-bg);text-align:center;padding:20px;border-top:1px solid var(--card-border);font-size:.9rem}.footer-text{color:var(--text-secondary)}.footer-accent{color:var(--primary);font-weight:600}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes slideIn{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}@keyframes pulse{0%{text-shadow:0 0 5px rgba(255,255,255,.5)}50%{text-shadow:0 0 20px rgba(255,255,255,.8)}to{text-shadow:0 0 5px rgba(255,255,255,.5)}}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 600px){.modern-app{max-width:100vw;margin:0;border-radius:0;min-height:100vh}.modern-main{padding:16px}.card{padding:20px 16px}.card.chat-card{height:65vh;max-height:65vh}.logo-title{font-size:2rem}.mode-group,.node-btn-group,.connection-btn-group{flex-direction:column;gap:12px}.message.sent{margin-left:10%}.message.received{margin-right:10%}.chat-input-area{padding:12px}}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:rgba(24,26,32,.5);border-radius:4px}::-webkit-scrollbar-thumb{background:var(--primary);border-radius:4px}::-webkit-scrollbar-thumb:hover{background:var(--primary-light)}\n/*$vite$:1*/',document.head.appendChild(e);const a=document.getElementById("mode-selection"),t=document.getElementById("node-panel"),r=document.getElementById("connection-panel"),n=document.getElementById("chat-panel"),o=document.getElementById("debug-panel"),i=document.getElementById("host-node-btn"),s=document.getElementById("join-network-btn"),d=document.getElementById("node-port"),c=document.getElementById("start-node-btn"),l=document.getElementById("stop-node-btn"),g=document.getElementById("node-status"),p=document.getElementById("room-id"),m=document.getElementById("generate-room"),b=document.getElementById("cipher-select"),v=document.getElementById("connect-btn"),u=document.getElementById("disconnect-btn"),f=document.getElementById("connection-status"),h=document.getElementById("messages"),x=document.getElementById("message-input"),y=document.getElementById("send-btn"),w=document.getElementById("chat-toggle"),k=document.getElementById("debug-toggle"),z=document.getElementById("debug-logs"),C=document.getElementById("clear-logs-btn"),E=document.getElementById("run-debug-btn"),S=document.getElementById("user-id-display"),I=document.getElementById("peer-status");let $=null,L=null,D=!1,j=!1,T="aes",B=null,N=null,R=null,A=new Map,M=0,P=null;const W={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.voipstunt.com"},{urls:"stun:stun.xten.com"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:freeturn.net:3478",username:"free",credential:"free"},{urls:"turn:freeturn.net:5349",username:"free",credential:"free"},{urls:"turns:freeturn.net:5349",username:"free",credential:"free"},{urls:"turn:turn.anyfirewall.com:443?transport=tcp",username:"webrtc",credential:"webrtc"},{urls:"turn:turn.bistri.com:80",username:"homeo",credential:"homeo"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},F=W.iceServers.map(e=>!e.urls.startsWith("turn:")||e.username&&e.credential?e:(console.warn("TURN server missing credentials:",e.urls),null)).filter(e=>null!==e);W.iceServers=F;let J=[];const O=["ws://localhost:52178","ws://localhost:8081","ws://localhost:8082"],Y=function(e,a){return new Promise((t,r)=>{R=new WebSocket(e),R.onopen=()=>{R.send(JSON.stringify({type:"join",room:a})),t()},R.onerror=e=>{console.error("Signaling socket error:",e),r(e)}})},G=function(e){R&&R.readyState===WebSocket.OPEN&&R.send(JSON.stringify({...e,room:N}))},q=function(e){R&&(R.onmessage=a=>{try{const t=JSON.parse(a.data);e(t)}catch(t){console.error("Signaling message parse error:",t)}})},H=function(){R&&(R.close(),R=null)},U=function(e){return new Promise(a=>{setTimeout(()=>{K("Node Running on port "+e,"status-running"),c.disabled=!0,l.disabled=!1,a()},1e3)})},X=function(){K("Node Stopped","status-stopped"),c.disabled=!1,l.disabled=!0};function V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let t=0;t<20;t++)a+=e.charAt(Math.floor(62*Math.random()));return a}function K(e,a){g.textContent=e,g.className=a}function Q(e,a){f.textContent=e,f.className=a,I&&(I.textContent=e,a.includes("connected")?I.style.color="#4CAF50":a.includes("disconnected")?I.style.color="#F44336":I.style.color="#FF9800")}function Z(e){const a=(new Date).toLocaleTimeString();if(J.push(`${a}: ${e}`),console.log(`[Connection Log] ${a}: ${e}`),void 0!==z&&z){const t=document.createElement("div");t.className="debug-log-entry",t.textContent=`[${a}] ${e}`,z.appendChild(t),z.scrollTop=z.scrollHeight}}function _(e){e.onopen=()=>{D=!0,Q("Connected","status-connected"),v.disabled=!0,u.disabled=!1,r.classList.add("hidden"),n.classList.remove("hidden")},e.onclose=()=>{D=!1,Q("Disconnected","status-disconnected"),v.disabled=!1,u.disabled=!0,n.classList.add("hidden"),r.classList.remove("hidden")},e.onerror=e=>{Z(`Data channel error: ${e.message}`),console.error("Data channel error:",e),D&&(Z("Attempting to restart data channel after error"),D=!1,Q("Data channel error, reconnecting...","status-disconnected"),setTimeout(()=>{$&&"connected"!==$.connectionState&&(Z("Restarting ICE after data channel error"),$.restartIce())},2e3))},e.onmessage=e=>{try{const a=JSON.parse(e.data);if("message"===a.type)ae(function(e,a){try{switch(a){case"aes":case"chacha20":return CryptoJS.AES.decrypt(e,B).toString(CryptoJS.enc.Utf8);case"rsa":return atob(e);default:return e}}catch(t){return console.error("Decryption error:",t),"[Decryption Error]"}}(a.content,T),"received");else if("delivery-confirmation"===a.type){const e=document.querySelector(`[data-message-id="${a.messageId}"]`);if(e){const a=e.querySelector(".message-status");a&&(a.textContent="✓✓",a.className="message-status delivered")}}}catch(a){console.error("Error processing message:",a)}}}function ee(){const e=x.value.trim();if(e&&D&&L)try{const a=function(e,a){switch(a){case"aes":case"chacha20":return CryptoJS.AES.encrypt(e,B).toString();case"rsa":return btoa(e);default:return e}}(e,T),t=++M,r={type:"message",content:a,timestamp:Date.now(),messageId:t};L.send(JSON.stringify(r)),ae(e,"sent",t),x.value="",A.set(t,{content:e,timestamp:Date.now()}),setTimeout(()=>{if(A.has(t)){const e=document.querySelector(`[data-message-id="${t}"]`);if(e){const a=e.querySelector(".message-status");a&&"✓"===a.textContent&&(a.textContent="⚠",a.className="message-status not-delivered")}A.delete(t)}},5e3)}catch(a){console.error("Error sending message:",a),alert("Failed to send message")}}function ae(e,a,t=null){const r=document.createElement("div");r.className=`message ${a}`,t&&r.setAttribute("data-message-id",t);const n=document.createElement("div");n.className="message-content",n.textContent=e;const o=document.createElement("div");if(o.className="message-info",o.textContent=(new Date).toLocaleTimeString(),"sent"===a){const e=document.createElement("span");e.className="message-status",e.textContent="✓",o.appendChild(e)}r.appendChild(n),r.appendChild(o),h.appendChild(r),h.scrollTop=h.scrollHeight}i.addEventListener("click",()=>{a.classList.add("hidden"),t.classList.remove("hidden")}),s.addEventListener("click",()=>{a.classList.add("hidden"),r.classList.remove("hidden")}),c.addEventListener("click",async()=>{const e=d.value||8080;K("Starting node...","status-stopped");try{await U(e)}catch(a){K("Failed to start node","status-stopped")}}),l.addEventListener("click",()=>{X()}),m.addEventListener("click",()=>{p.value=V()}),b.addEventListener("change",()=>{T=b.value}),v.addEventListener("click",async()=>{if(N=p.value.trim(),!N)return void alert("Please enter or generate a room ID");let e;Q("Discovering network...","status-disconnected");try{e=await async function(e){Q("Discovering network...","status-disconnected");for(const t of O)try{return Q(`Trying ${t}...`,"status-disconnected"),await Y(t,e),t}catch(a){console.log(`Failed to connect to ${t}`);continue}throw new Error("No available signaling servers found")}(N)}catch(a){return void Q("No available servers","status-disconnected")}await async function(){switch(T){case"aes":case"chacha20":B=CryptoJS.lib.WordArray.random(32);break;case"rsa":B="rsa-key-placeholder"}j&&setTimeout(()=>{G({type:"key",cipher:T,key:B.toString()})},2e3)}(),q(e=>{var a;"init"===e.type?(j=e.initiator,function(){try{Q("Establishing peer connection...","status-disconnected"),Z("Starting WebRTC connection setup"),$=new RTCPeerConnection(W),Z("RTCPeerConnection created");const e=setTimeout(()=>{"connected"!==$.connectionState&&"completed"!==$.connectionState&&(Z("Connection timeout - no connection established"),Q("Connection timeout","status-disconnected"),"checking"!==$.iceConnectionState&&"disconnected"!==$.iceConnectionState||(Z("Attempting ICE restart after timeout"),$.restartIce()))},6e4);$.onconnectionstatechange=()=>{Z(`Connection state: ${$.connectionState}`),Q(`Connection: ${$.connectionState}`,"status-disconnected"),"connected"!==$.connectionState&&"completed"!==$.connectionState||clearTimeout(e),"failed"===$.connectionState&&(Z("Connection failed, attempting to restart ICE"),$.restartIce()),"disconnected"===$.connectionState&&(Z("Connection disconnected, monitoring for reconnection"),setTimeout(()=>{"disconnected"===$.connectionState&&(Z("Connection still disconnected, attempting to restart ICE"),$.restartIce())},1e4))},$.onsignalingstatechange=()=>{Z(`Signaling state: ${$.signalingState}`)},$.oniceconnectionstatechange=()=>{Z(`ICE connection state: ${$.iceConnectionState}`),"failed"===$.iceConnectionState&&(Z("ICE connection failed, attempting to restart ICE"),$.restartIce()),"disconnected"===$.iceConnectionState&&Z("ICE connection disconnected, monitoring for reconnection")},$.onicegatheringstatechange=()=>{Z(`ICE gathering state: ${$.iceGatheringState}`),"gathering"===$.iceGatheringState&&setTimeout(()=>{"gathering"===$.iceGatheringState&&(Z("ICE gathering timeout - forcing completion"),$.onicecandidate({candidate:null}))},3e4)},$.onicecandidate=e=>{e.candidate?(Z(`ICE candidate gathered: ${e.candidate.type} (${e.candidate.protocol})`),G({type:"candidate",candidate:e.candidate})):Z("ICE candidate gathering complete")},$.onicecandidateerror=e=>{Z(`ICE candidate error: ${e.errorCode} - ${e.errorText} (${e.url})`),console.error("ICE candidate error:",e),"complete"===$.iceGatheringState&&Z("ICE gathering completed despite errors"),"gathering"===$.iceGatheringState&&(Z("Attempting to restart ICE after candidate error"),setTimeout(()=>{"gathering"===$.iceGatheringState&&(Z("Forcing ICE gathering completion after error"),$.onicecandidate({candidate:null}))},5e3))},j?(Z("Creating data channel (initiator)"),L=$.createDataChannel("messaging",{ordered:!0,maxRetransmits:3}),_(L),Z("Creating offer"),$.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1}).then(e=>(Z("Offer created, setting local description"),$.setLocalDescription(e))).then(()=>{Z("Local description set, sending offer"),G({type:"offer",offer:$.localDescription})}).catch(e=>{Z(`Error creating offer: ${e.message}`),console.error("Error creating offer:",e),Q("Connection failed","status-disconnected")})):(Z("Waiting for data channel (non-initiator)"),$.ondatachannel=e=>{Z("Data channel received"),L=e.channel,L.binaryType="arraybuffer",_(L)})}catch(e){Z(`Error starting connection: ${e.message}`),console.error("Error starting connection:",e),Q("Connection failed","status-disconnected")}}()):"key"===e.type?"key"===(a=e).type&&(B=CryptoJS.enc.Hex.parse(a.key),Z(`Encryption key received for ${a.cipher}`)):function(e){if($)switch(Z(`Received signaling message: ${e.type}`),e.type){case"offer":Z("Processing offer"),$.setRemoteDescription(new RTCSessionDescription(e.offer)).then(()=>(Z("Remote offer set, creating answer"),$.createAnswer())).then(e=>(Z("Answer created, setting local description"),$.setLocalDescription(e))).then(()=>{Z("Local answer set, sending answer"),G({type:"answer",answer:$.localDescription})}).catch(e=>{Z(`Error handling offer: ${e.message}`),console.error("Error handling offer:",e)});break;case"answer":Z("Processing answer"),$.setRemoteDescription(new RTCSessionDescription(e.answer)).then(()=>{Z("Remote answer set successfully")}).catch(e=>{Z(`Error handling answer: ${e.message}`),console.error("Error handling answer:",e)});break;case"candidate":Z(`Adding ICE candidate: ${e.candidate.type}`),$.addIceCandidate(new RTCIceCandidate(e.candidate)).then(()=>{Z("ICE candidate added successfully")}).catch(e=>{Z(`Error adding ICE candidate: ${e.message}`),console.error("Error adding ICE candidate:",e)});break;default:Z(`Unknown signaling message type: ${e.type}`)}else Z("Received signaling message but no peer connection exists")}(e)})}),u.addEventListener("click",()=>{L&&L.close(),$&&$.close(),H(),D=!1,Q("Disconnected","status-disconnected"),v.disabled=!1,u.disabled=!0,n.classList.add("hidden"),r.classList.remove("hidden"),h.innerHTML="",A.clear()}),y.addEventListener("click",ee),x.addEventListener("keypress",e=>{"Enter"===e.key&&ee()}),document.addEventListener("DOMContentLoaded",()=>{K("Node Stopped","status-stopped"),Q("Disconnected","status-disconnected"),p.value=V(),P=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let a="CW-";for(let t=0;t<6;t++)a+=e.charAt(Math.floor(36*Math.random()));return a}(),S&&(S.textContent=P),o.classList.remove("hidden")}),w.addEventListener("click",()=>{const e=document.querySelector("#messages");"none"===e.style.display?(e.style.display="block",w.textContent="▼"):(e.style.display="none",w.textContent="▶")}),k.addEventListener("click",()=>{const e=document.querySelector("#debug-content");"none"===e.style.display?(e.style.display="block",k.textContent="▼"):(e.style.display="none",k.textContent="▶")}),C.addEventListener("click",()=>{z.innerHTML="",J=[]}),E.addEventListener("click",()=>{!function(){const e=document.createElement("div");e.className="debug-log-entry";let a="=== CipherWave Debug Report ===\n";a+=`Time: ${(new Date).toLocaleString()}\n`,a+=`User ID: ${P||"Not generated"}\n\n`,a+=`WebRTC Support: ${!!window.RTCPeerConnection}\n`,a+=`WebSocket Support: ${!!window.WebSocket}\n`,a+=`Crypto Support: ${!!window.crypto}\n\n`,a+=`Online Status: ${navigator.onLine}\n\n`,void 0!==R&&R?(a+=`Signaling Server Status: ${R.readyState}\n`,a+=`Signaling Server URL: ${R.url||"N/A"}\n\n`):a+="Signaling Server: Not connected\n\n",void 0!==$&&$?(a+=`Peer Connection State: ${$.connectionState}\n`,a+=`Signaling State: ${$.signalingState}\n`,a+=`ICE Connection State: ${$.iceConnectionState}\n`,a+=`ICE Gathering State: ${$.iceGatheringState}\n\n`):a+="Peer Connection: Not established\n\n",void 0!==L&&L?(a+=`Data Channel State: ${L.readyState}\n`,a+=`Data Channel Label: ${L.label}\n\n`):a+="Data Channel: Not established\n\n",void 0!==J&&J&&J.length>0?(a+="=== Recent Connection Events ===\n",a+=J.slice(-10).join("\n")):a+="=== No Connection Events ===\n",a+="\n=== End Debug Report ===",e.textContent=a,z.appendChild(e),z.scrollTop=z.scrollHeight}()})}}});
//# sourceMappingURL=index-legacy-CgY4zHRK.js.map
